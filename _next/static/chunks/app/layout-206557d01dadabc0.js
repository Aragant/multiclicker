(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{619:(e,r,o)=>{Promise.resolve().then(o.bind(o,9720)),Promise.resolve().then(o.t.bind(o,6874,23)),Promise.resolve().then(o.t.bind(o,5688,23)),Promise.resolve().then(o.t.bind(o,9432,23)),Promise.resolve().then(o.t.bind(o,9324,23)),Promise.resolve().then(o.t.bind(o,5904,23)),Promise.resolve().then(o.t.bind(o,3063,23))},986:(e,r,o)=>{"use strict";o.d(r,{B:()=>t});class t{}t.LOGIN="login",t.CLICK="click",t.CLICKED="clicked",t.SET_GAME_INFO="SET_GAME_INFO"},3063:()=>{},4671:(e,r,o)=>{"use strict";o.d(r,{P:()=>t});let t=(0,o(2115).createContext)(null)},5688:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_f90177",variable:"__variable_f90177"}},5695:(e,r,o)=>{"use strict";var t=o(8999);o.o(t,"usePathname")&&o.d(r,{usePathname:function(){return t.usePathname}}),o.o(t,"useRouter")&&o.d(r,{useRouter:function(){return t.useRouter}})},5904:()=>{},9265:(e,r,o)=>{"use strict";o.d(r,{A:()=>l});class t{static save(e,r){try{localStorage.setItem(this.playerIdKey,e),localStorage.setItem(this.guildIdKey,r)}catch(e){console.error("Failed to save player name:",e)}}static getGuildId(){try{let e=localStorage.getItem(this.guildIdKey);if("null"===e)return null;return e}catch(e){return console.error("Failed to get guild ID:",e),null}}static getPlayerId(){try{return localStorage.getItem(this.playerIdKey)}catch(e){return console.error("Failed to get player ID:",e),null}}static clear(){try{localStorage.removeItem(this.playerIdKey),localStorage.removeItem(this.guildIdKey)}catch(e){console.error("Failed to clear player name:",e)}}}t.playerIdKey="player_id",t.guildIdKey="guild_id";let l=t},9324:()=>{},9432:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_46bb7d",variable:"__variable_46bb7d"}},9720:(e,r,o)=>{"use strict";o.d(r,{WebSocketProvider:()=>S});var t=o(5155),l=o(2115),a=o(986);let s=(e,r)=>{(0,l.useEffect)(()=>{if(e)return function(e,r){e.onmessage=e=>{c(e,r)},e.onclose=()=>console.log("WebSocket ferm\xe9."),e.onerror=e=>console.error("WebSocket erreur :",e)}(e,r),()=>{e.close()}},[e,r])},c=async(e,r)=>{console.log("Message re\xe7u : ",e);let o=await JSON.parse(e.data);switch(console.log(" ???  ",o),console.log(" ???  ",o.type),console.log(" ???  ",o.sumScore),o.type){case a.B.CLICKED:r({type:"SET_SUM_SCORE",payload:o.sumScore}),r({type:"SET_PLAYER_SCORE",payload:o.player});break;case a.B.SET_GAME_INFO:r({type:"SET_GAME_INFO",payload:o.game})}console.log("Message re\xe7u : ",o)},n={sumScore:0,playerScore:[]},i=(e,r)=>{switch(r.type){case"SET_SUM_SCORE":return console.log("SET_SUM_SCORE",r.payload),{...e,sumScore:r.payload};case"SET_PLAYER_SCORE":return console.log("SET_PLAYER_SCORE",r.payload),function(e,r){let o=r.playerScore.findIndex(r=>r.username===e.username);-1===o?r.playerScore.push(e):r.playerScore[o].score=e.score}(r.payload,e),{...e,playerScore:[...e.playerScore]};case"SET_PLAYER_NAME":return{...e};case"SET_GAME_INFO":return{...e,sumScore:r.payload.sumScore,playerScore:r.payload.playerScore};default:return e}};var u=o(4671),d=o(9265),y=o(5695);let S=e=>{let{children:r}=e,[o,a]=(0,l.useReducer)(i,n),[c,S]=(0,l.useState)(null),_=(0,y.usePathname)();return(0,l.useEffect)(()=>{let e=d.A.getPlayerId(),r=d.A.getGuildId();if(!e||!r)return void console.log("connect to clanId");if(!e){c&&(c.close(),S(null));return}let o=new WebSocket("".concat("wss://api-multiclicker.fly.dev/ws"));return S(o),o.onopen=()=>{console.log("WebSocket connected"),o.send(JSON.stringify({type:"login",playerId:e}))},o.onclose=()=>{console.log("WebSocket disconnected")},o.onerror=e=>{console.error("WebSocket error:",e)},()=>{o&&o.close()}},[_]),s(c,a),(0,t.jsx)(u.P.Provider,{value:{websocket:c,state:o,dispatch:a},children:r})}}},e=>{var r=r=>e(e.s=r);e.O(0,[480,874,441,684,358],()=>r(619)),_N_E=e.O()}]);