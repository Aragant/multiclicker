(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{619:(e,r,t)=>{Promise.resolve().then(t.bind(t,9720)),Promise.resolve().then(t.t.bind(t,6874,23)),Promise.resolve().then(t.t.bind(t,5688,23)),Promise.resolve().then(t.t.bind(t,9432,23)),Promise.resolve().then(t.t.bind(t,9324,23)),Promise.resolve().then(t.t.bind(t,5904,23)),Promise.resolve().then(t.t.bind(t,3063,23))},986:(e,r,t)=>{"use strict";t.d(r,{B:()=>l});class l{}l.LOGIN="login",l.CLICK="click",l.CLICKED="clicked",l.SET_GAME_INFO="SET_GAME_INFO"},3063:()=>{},4671:(e,r,t)=>{"use strict";t.d(r,{P:()=>l});let l=(0,t(2115).createContext)(null)},5688:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},5695:(e,r,t)=>{"use strict";var l=t(8999);t.o(l,"usePathname")&&t.d(r,{usePathname:function(){return l.usePathname}}),t.o(l,"useRouter")&&t.d(r,{useRouter:function(){return l.useRouter}})},5904:()=>{},9265:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});class l{static save(e,r){try{localStorage.setItem(this.playerIdKey,e),localStorage.setItem(this.guildIdKey,r)}catch(e){console.error("Failed to save player name:",e)}}static getGuildId(){try{let e=localStorage.getItem(this.guildIdKey);if("null"===e)return null;return e}catch(e){return console.error("Failed to get guild ID:",e),null}}static getPlayerId(){try{return localStorage.getItem(this.playerIdKey)}catch(e){return console.error("Failed to get player ID:",e),null}}static clear(){try{localStorage.removeItem(this.playerIdKey),localStorage.removeItem(this.guildIdKey)}catch(e){console.error("Failed to clear player name:",e)}}}l.playerIdKey="player_id",l.guildIdKey="guild_id";let o=l},9324:()=>{},9432:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9720:(e,r,t)=>{"use strict";t.d(r,{WebSocketProvider:()=>S});var l=t(5155),o=t(2115),a=t(986);let s=(e,r)=>{(0,o.useEffect)(()=>{if(e)return function(e,r){e.onmessage=e=>{c(e,r)},e.onclose=()=>console.log("WebSocket ferm\xe9."),e.onerror=e=>console.error("WebSocket erreur :",e)}(e,r),()=>{e.close()}},[e,r])},c=(e,r)=>{let t=JSON.parse(e.data);switch(t.type){case a.B.CLICKED:r({type:"SET_SUM_SCORE",payload:t.sumScore}),r({type:"SET_PLAYER_SCORE",payload:t.player});break;case a.B.SET_GAME_INFO:r({type:"SET_GAME_INFO",payload:t.game})}console.log("Message re\xe7u : ",t)},n={sumScore:0,playerScore:[]},i=(e,r)=>{switch(r.type){case"SET_SUM_SCORE":return{...e,sumScore:r.payload};case"SET_PLAYER_SCORE":return function(e,r){let t=r.playerScore.findIndex(r=>r.username===e.username);-1===t?r.playerScore.push(e):r.playerScore[t].sumScore=e.sumScore}(r.payload,e),{...e,playerScore:[...e.playerScore]};case"SET_PLAYER_NAME":return{...e};case"SET_GAME_INFO":return{...e,sumScore:r.payload.sumScore,playerScore:r.payload.playerScore};default:return e}};var u=t(4671),d=t(9265),y=t(5695);let S=e=>{let{children:r}=e,[t,a]=(0,o.useReducer)(i,n),[c,S]=(0,o.useState)(null),m=(0,y.usePathname)();return(0,o.useEffect)(()=>{let e=d.A.getPlayerId();if(!e){c&&(c.close(),S(null));return}let r=new WebSocket("".concat("wss://api-multiclicker.fly.dev/ws"));return S(r),r.onopen=()=>{console.log("WebSocket connected"),r.send(JSON.stringify({type:"login",username:e}))},r.onclose=()=>{console.log("WebSocket disconnected")},r.onerror=e=>{console.error("WebSocket error:",e)},()=>{r&&r.close()}},[m]),s(c,a),(0,l.jsx)(u.P.Provider,{value:{websocket:c,state:t,dispatch:a},children:r})}}},e=>{var r=r=>e(e.s=r);e.O(0,[480,874,441,684,358],()=>r(619)),_N_E=e.O()}]);